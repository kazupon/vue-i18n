# Синтаксис сообщений локализации

## Структура

Синтаксис сообщений локализации:

```typescript
// As Flowtype definition, Locale Messages syntax like BNF annotation
type LocaleMessages = { [key: Locale]: LocaleMessageObject }
type LocaleMessageObject = { [key: Path]: LocaleMessage }
type LocaleMessageArray = LocaleMessage[]
type LocaleMessage = string | LocaleMessageObject | LocaleMessageArray
type Locale = string
type Path = string
```

Используя синтаксис выше, можно создать следующую структуру сообщений локализации:

```json
{
  // локализация 'en'
  "en": {
    "key1": "это сообщение 1", // обычное использование
    "nested": {
      // вложенное
      "message1": "это вложенное сообщение 1"
    },
    "errors": [
      // массив
      "это сообщение кода ошибки 0",
      {
        // объект в массиве
        "internal1": "это внутреннее сообщение кода ошибки 1"
      },
      [
        // массив в массиве
        "это вложенный массив ошибки 1"
      ]
    ]
  },
  // локализация 'ru'
  "ru": {
    // ...
  }
}
```

Для такой структуры сообщений локализации, можно переводить сообщения используя ключи:

```html
<div id="app">
  <!-- обычное использование -->
  <p>{{ $t('key1') }}</p>
  <!-- вложенное -->
  <p>{{ $t('nested.message1') }}</p>
  <!-- массив -->
  <p>{{ $t('errors[0]') }}</p>
  <!-- объект в массиве -->
  <p>{{ $t('errors[1].internal1') }}</p>
  <!-- массив в массиве -->
  <p>{{ $t('errors[2][0]') }}</p>
</div>
```

Результат:

```html
<div id="app">
  <!-- обычное использование -->
  <p>это сообщение 1</p>
  <!-- вложенное -->
  <p>это вложенное сообщение 1</p>
  <!-- массив -->
  <p>это сообщение кода ошибки 0</p>
  <!-- объект в массиве -->
  <p>это внутреннее сообщение кода ошибки 1</p>
  <!-- массив в массиве -->
  <p>это вложенный массив ошибки 1</p>
</div>
```

## Связанные сообщения локализации

Если есть ключ для перевода, который также встречается этим же конкретным текстом в другом, то можно просто сослаться на него. Чтобы сделать ссылку на другой ключ сообщений перевода, всё что нужно сделать, это добавить префикс к его содержимому с помощью сочетания `@:` после которого указать полное имя ключа перевода, включая пространство имён, к которому требуется сделать ссылку.

Сообщения локализации:

```js
const messages = {
  en: {
    message: {
      the_world: 'the world',
      dio: 'DIO:',
      linked: '@:message.dio @:message.the_world !!!!'
    }
  }
}
```

Шаблон:

```html
<p>{{ $t('message.linked') }}</p>
```

Результат:

```html
<p>DIO: the world !!!!</p>
```

### Форматирование связанных сообщений локализации

Если для языка важен регистр символов, то может потребоваться управлять регистром связанного сообщения локализации. Связанные сообщения можно отформатировать используя модификатор `@.modifier:key`

В настоящий момент доступны следующие модификаторы.

- `upper`: Перевести в верхний регистр все символы в связанном сообщении.
- `lower`: Перевести в нижний регистр все символы в связанном сообщении.
- `capitalize`: Сделать заглавной первую букву в связанном сообщении.

Сообщения локализации:

```js
const messages = {
  en: {
    message: {
      homeAddress: 'Home address',
      missingHomeAddress: 'Please provide @.lower:message.homeAddress'
    }
  },
  ru: {
    message: {
      homeAddress: 'Домашний адрес',
      missingHomeAddress: 'Пожалуйста укажите @.lower:message.homeAddress'
    }
  }
}
```

```html
<label>{{ $t('message.homeAddress') }}</label>

<p class="error">{{ $t('message.missingHomeAddress') }}</p>
```

Результат:

```html
<label>Домашний адрес</label>

<p class="error">Пожалуйста укажите домашний адрес</p>
```

Можно добавлять новые модификаторы или перезаписывать существующие, с помощью опции `modifiers` конструктора `VueI18n`.

```js
const i18n = new VueI18n({
  locale: 'ru',
  messages: {
    // ...
  },
  modifiers: {
    snakeCase: str => str.split(' ').join('-')
  }
})
```

### Группировка в скобках

Ключ перевода связанного сообщения также может иметь форму `@:(message.foo.bar.baz)` в которой ссылка на другой ключ перевода заключена в скобки `()`.

Это может быть полезно, если за ссылкой `@:message.something` указана точка `.`, которая в противном случае считалась бы частью ссылки и, возможно, не должна быть её частью.

Сообщения локализации:

```js
const messages = {
  en: {
    message: {
      dio: 'DIO',
      linked: "There's a reason, you lost, @:(message.dio)."
    }
  }
}
```

Шаблон:

```html
<p>{{ $t('message.linked') }}</p>
```

Результат:

```html
<p>There's a reason, you lost, DIO.</p>
```
